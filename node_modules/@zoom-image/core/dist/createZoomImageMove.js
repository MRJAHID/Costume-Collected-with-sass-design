'use strict';

var F=()=>{let e=new Set,a=o=>e.has(o);return {createZoomImage:({src:o,store:r,img:c})=>{c.src=o,!a(o)&&(e.add(o),r.setState({zoomedImgStatus:"loading"}),c.addEventListener("load",()=>{r.setState({zoomedImgStatus:"loaded"});}),c.addEventListener("error",()=>{r.setState({zoomedImgStatus:"error"});}));},checkImageLoaded:a}},u=F();function p(e){let a=new Set,i=!1,o=e,r,c=(t={})=>{r={...r,...t},l();},l=()=>{if(i)return;let t=!1;if(r){for(let s in r)if(o[s]!==r[s]){t=!0;break}}t&&(o={...o,...r},a.forEach(s=>s({state:o,updatedProperties:r})),r=void 0);};return {subscribe:t=>(a.add(t),()=>{a.delete(t);}),cleanup:()=>a.clear(),getState:()=>o,setState:c,batch:t=>{i=!0,t(),i=!1,l();}}}function d(e){e.preventDefault();}var Z=new Set(["ArrowUp","ArrowRight","ArrowDown","ArrowLeft"]);function C(e){if(Z.has(e.key))return d(e),!1}var f;function v(){f=new AbortController;let{signal:e}=f;window.addEventListener("DOMMouseScroll",d,{signal:e}),window.addEventListener("wheel",d,{passive:!1,signal:e}),window.addEventListener("touchmove",d,{passive:!1,signal:e}),window.addEventListener("keydown",C,{signal:e});}function y(){f?.abort();}function z(e){if(!e)throw new Error("Please specify a container for the zoom image");let a=e.querySelector("img");if(!a)throw new Error("Please place an image inside the container");return a}function $(e,a={}){let i=z(e),o={zoomFactor:a.zoomFactor??4,zoomImageSource:a.zoomImageSource??i.src},r=p({zoomedImgStatus:u.checkImageLoaded(o.zoomImageSource)?"loaded":"idle"}),c=i.clientWidth*o.zoomFactor,l=i.clientHeight*o.zoomFactor,t=e.appendChild(document.createElement("img"));t.style.maxWidth="none",t.style.width=`${c}px`,t.style.height=`${l}px`,t.style.position="absolute",t.style.top="0",t.style.left="0";function s(n){t.style.display="block",u.createZoomImage({img:t,src:o.zoomImageSource,store:r}),S(n),v();}function x(n){S(n);}function E(){y(),t.style.display="none",t.style.transform="none";}let w=n=>{let m=e.clientWidth;return n>0?0:n+m*o.zoomFactor<m?-m*(o.zoomFactor-1):n},P=n=>{let m=e.clientHeight;return n>0?0:n+m*o.zoomFactor<m?-m*(o.zoomFactor-1):n};function S(n){t.style.display="block",u.createZoomImage({img:t,src:o.zoomImageSource,store:r});let m=e.getBoundingClientRect(),h=n.clientX-m.left,I=n.clientY-m.top,L=w(-h*o.zoomFactor+h),M=P(-I*o.zoomFactor+I);t.style.transform=`translate(${L}px, ${M}px)`;}let b=new AbortController,{signal:g}=b;return e.addEventListener("pointerenter",s,{signal:g}),e.addEventListener("pointermove",x,{signal:g}),e.addEventListener("pointerleave",E,{signal:g}),{cleanup:()=>{b.abort(),e.removeChild(t),r.cleanup();},subscribe:r.subscribe,getState:r.getState}}

exports.createZoomImageMove = $;
//# sourceMappingURL=out.js.map
//# sourceMappingURL=createZoomImageMove.js.map